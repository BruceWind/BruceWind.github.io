{"pageProps":{"post":{"slug":"android 顶部悬停效果 浮动布局","title":"android 顶部悬停效果 浮动布局.md","mdsource":"md/android 顶部悬停效果 浮动布局.md","date":" 2015/11/29 23:36:42","category":"几年后回看会觉得写的太烂"},"content":"title: android 顶部悬停效果 浮动布局\ndate: 2015/11/29 23:36:42\nupdated: 2015/11/29 23:48:01\ncategories:\n- 技术\n---\n来不及解释了，上代码：\n\n``` xml\n\n\n    <declare-styleable name=\"FloatScrollView\">\n    <!-- Positions the right edge of this view to the left of the given anchor view ID. -->\n    <attr name=\"floatid\" format=\"reference\" />\n        <attr name=\"copyid\" format=\"reference\" />\n    </declare-styleable>\n```\n\nFLoatScrollView类\n\n``` java\n\npackage com.widgets;\n\nimport android.content.Context;\nimport android.content.res.TypedArray;\nimport android.graphics.Canvas;\nimport android.util.AttributeSet;\nimport android.view.View;\nimport android.widget.ScrollView;\n\nimport com.mvp.R;\n\n/**\n * Created by xxx on 15-10-14.\n */\npublic class FloatScrollView extends ScrollView {\n\n    //需要浮动区域的顶部的view的高度  这里强制要求浮动区域的控件往上到达ScrollView  必须得是一个View\n    View mFloatView;\n    //代替展示浮动view\n    View mFlowView;\n\n    int flowid;\n    int floatid;\n\n    public FloatScrollView(Context context) {\n        super(context);\n    }\n\n    public FloatScrollView(Context context, AttributeSet attrs) {\n        super(context, attrs);\n        initView(attrs);\n    }\n\n    public FloatScrollView(Context context, AttributeSet attrs, int defStyle) {\n        super(context, attrs, defStyle);\n\n        initView(attrs);\n    }\n\n    private void initView(AttributeSet attrs)\n    {\n        TypedArray obtainStyled = getContext().obtainStyledAttributes(attrs, R.styleable.FloatScrollView);\n        flowid=obtainStyled.getResourceId(R.styleable.FloatScrollView_copyid,0);\n        floatid=obtainStyled.getResourceId(R.styleable.FloatScrollView_floatid, 0);\n    }\n\n\n    @Override\n    protected void onDraw(Canvas canvas) {\n\n\t//这几句代码我也不想写在onDraw中 写在init方法里最好不过只是 那样子 无法find view\n        mFloatView = getRootView().findViewById(floatid);\n        mFlowView = getRootView().findViewById(flowid);\n        super.onDraw(canvas);\n    }\n\n    @Override\n    protected void onScrollChanged(int l, int t, int oldl, int oldt) {\n\n        super.onScrollChanged(l, t, oldl, oldt);\n\n\n\n        if(mFloatView != null && mFlowView!=null) {\n\n            if(t >= mFloatView.getHeight()) {\n                mFlowView.setVisibility(View.VISIBLE);\n            } else {\n                mFlowView.setVisibility(View.GONE);\n            }\n        }\n    }\n}\n\n\n```\n\n\n上图 ：  \n\n\n![](assets/565b1d7eab6441515b000333.JPEG)\n\n# \n\n![](assets/565b1d7eab6441515b000334.JPEG)\n\n\n看布局代码记得寻找其中的 view_float_copy\n\n```  xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:background=\"@color/bg_layout\"\n    android:layout_height=\"match_parent\">\n\n    <com.cores.widget.Topbar\n        android:id=\"@+id/topbar\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\" />\n\n    <FrameLayout\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\">\n\n\n\n    <com.widgets.FloatScrollView\n        app:floatid=\"@+id/view_float\"\n        app:copyid=\"@+id/view_float_copy\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:id=\"@+id/scrollView\" >\n\n    <LinearLayout\n        android:orientation=\"vertical\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"match_parent\">\n\n    <RelativeLayout\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"\n        android:padding=\"10dp\">\n\n        <RelativeLayout\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:background=\"@drawable/corner_search_border_gray\">\n\n            <EditText\n                style=\"@style/font14_gray_white\" android:hint=\"请输入会员卡号、姓名、手机号\" android:drawableRight=\"@drawable/user_search\"\n                android:background=\"@color/clear\"\n                android:layout_width=\"match_parent\"\n                android:padding=\"6dp\" />\n\n\n        </RelativeLayout>\n    </RelativeLayout>\n\n    <RelativeLayout\n        android:id=\"@+id/view_float\"\n        android:background=\"@drawable/bordergray_topbot_stokwhite\"\n        android:gravity=\"center_vertical\"\n        style=\"@style/hor_container\">\n\n\n        <CheckBox\n            android:layout_width=\"wrap_content\"\n            android:layout_height=\"wrap_content\"\n            android:button=\"@drawable/selector_check\"\n            android:text=\" 全选\"\n            android:layout_centerVertical=\"true\"\n            style=\"@style/font14_balck\"\n            android:id=\"@+id/check_allsel\"\n            android:checked=\"false\" />\n\n        <TextView\n            style=\"@style/font13_gray\"\n            android:id=\"@+id/txt_membercount\"\n            android:textColor=\"@color/grey_a4a4a4\"\n            android:text=\"共0位会员\"\n            android:layout_centerVertical=\"true\"\n            android:layout_toRightOf=\"@+id/check_allsel\"\n            android:layout_toEndOf=\"@+id/check_allsel\"\n            android:layout_marginLeft=\"15dp\"\n            android:layout_marginStart=\"15dp\" />\n\n        <TextView\n            style=\"@style/font14\"\n            android:id=\"@+id/txt_btn_adduser\"\n            android:textColor=\"@color/home_rad_txt_blue\"\n            android:background=\"@drawable/corner_search_border_gray\"\n            android:text=\"新增会员\"\n            android:padding=\"5dp\"\n            android:layout_centerVertical=\"true\"\n            android:layout_alignParentRight=\"true\"\n            android:layout_alignParentEnd=\"true\" />\n    </RelativeLayout>\n\n    <com.cores.widget.bugfixview.FixRowListView\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"\n        android:id=\"@+id/list_member\"\n        android:layout_gravity=\"center_horizontal\" />\n    </LinearLayout>\n\n    </com.widgets.FloatScrollView>\n\n\n        <RelativeLayout\n            android:background=\"@drawable/bordergray_topbot_stokwhite\"\n            android:gravity=\"center_vertical\"\n            style=\"@style/hor_container\"\n            android:id=\"@+id/view_float_copy\"\n            android:visibility=\"gone\">\n\n\n            <CheckBox\n                android:layout_width=\"wrap_content\"\n                android:layout_height=\"wrap_content\"\n                android:button=\"@drawable/selector_check\"\n                android:text=\" 全选\"\n                android:layout_centerVertical=\"true\"\n                style=\"@style/font14_balck\"\n                android:id=\"@+id/check_allsel_copy\"/>\n\n            <TextView\n                style=\"@style/font13_gray\"\n                android:textColor=\"@color/grey_a4a4a4\"\n                android:text=\"共0位会员\"\n                android:layout_centerVertical=\"true\"\n                android:layout_toRightOf=\"@+id/check_allsel_copy\"\n                android:layout_toEndOf=\"@+id/check_allsel_copy\"\n                android:layout_marginLeft=\"15dp\"\n                android:layout_marginStart=\"15dp\" />\n\n            <TextView\n                android:id=\"@+id/txt_btn_adduser_copy\"\n                style=\"@style/font14\"\n                android:textColor=\"@color/home_rad_txt_blue\"\n                android:background=\"@drawable/corner_search_border_gray\"\n                android:text=\"新增会员\"\n                android:padding=\"5dp\"\n                android:layout_centerVertical=\"true\"\n                android:layout_alignParentRight=\"true\"\n                android:layout_alignParentEnd=\"true\" />\n        </RelativeLayout>\n    </FrameLayout>\n</LinearLayout>\n\n\n```\n\n主要就是Frame布局 选择性的显示 那个copy的view，浮动的原理就是这样子的。","lang":"cn"},"__N_SSG":true}